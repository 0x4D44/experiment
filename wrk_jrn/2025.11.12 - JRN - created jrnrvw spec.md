# 2025.11.12 - Journal Review Tool Specification

## Overview
Created comprehensive specification for a new Rust CLI tool called "jrnrvw" (Journal Review Tool) to analyze task journal files across directory trees.

## Tasks Completed

### Project Setup
- Created new subdirectory `jrnrvw/` for future tool implementation
- Created `wrk_docs/` directory for documentation storage
- Created `wrk_jrn/` directory for work journals (this file!)

### Specification Document
Created detailed specification document: `wrk_docs/2025.11.12 - Journal Review Tool Specification.md`

**Key Features Specified:**
1. **File Discovery**
   - Recursive search for journal files matching pattern `yyyy.mm.dd - JRN - *.md`
   - Date extraction from filenames
   - Git repository boundary detection

2. **Content Analysis**
   - Markdown parsing
   - Task identifier extraction (GitHub issues, JIRA tickets, custom formats)
   - Activity extraction from journal entries

3. **Grouping & Organization**
   - Primary hierarchy: Repository → Task → Journal Entries
   - Support for nested repositories
   - Handling of ungrouped entries

4. **Time Range Filtering**
   - Predefined ranges: last week, last month, this week, this month
   - Custom date ranges (from/to)
   - Activity-based filtering (last N active days)
   - Distinction between calendar days and actual activity days

5. **Output Formats**
   - Text (default with tree structure)
   - JSON (structured data export)
   - Markdown (report generation)
   - HTML (future enhancement)
   - Summary mode for quick overviews

### Technical Design

**Architecture Components:**
- File Scanner Module (directory traversal, pattern matching)
- Parser Module (markdown, task extraction)
- Analyzer Module (grouping, filtering, statistics)
- Formatter Module (output rendering)
- CLI Module (argument parsing with clap)

**Key Dependencies:**
- `clap` for CLI
- `chrono` for date handling
- `walkdir` for directory traversal
- `pulldown-cmark` for markdown parsing
- `serde/serde_json` for JSON output
- `colored` for terminal output

**Data Structures:**
- JournalFile, JournalEntry, Repository
- TaskReference with TaskType enum (GitHub, Jira, Custom, Heading)
- AnalysisResult with grouping hierarchy
- Summary statistics

### Implementation Plan
Outlined 5-phase implementation:
1. Core functionality (scanning, basic CLI, text output)
2. Enhanced analysis (task extraction, date filtering)
3. Output formats (JSON, markdown, HTML)
4. Advanced features (task merging, search, config)
5. Polish & optimization (performance, shell completions, docs)

## Design Decisions

### Journal File Format
- Chose markdown for human readability
- Date-first naming for easy sorting
- "JRN" identifier for clear categorization
- Flexible description field for context

### Grouping Strategy
- Repository as primary group (matches typical workflow)
- Task as secondary group (tracks work across time)
- Chronological within groups
- Separate ungrouped entries section

### Time Filtering Philosophy
- Both calendar-based and activity-based options
- Activity-based filters exclude gaps (weekends, vacations)
- Useful for "show me the last 7 days I actually worked"

### Task Identification
- Support multiple formats (GitHub, JIRA, custom)
- Regex-based extraction for flexibility
- Future config file for custom patterns
- Handle multiple tasks per journal entry

## Next Steps
1. Review and approve specification
2. Set up Rust project structure in `jrnrvw/` directory
3. Implement Phase 1 (core functionality)
4. Create test fixtures and unit tests
5. Iterate based on real-world usage

## Reflections
- The tool addresses a real need for developers maintaining work journals
- Grouping by repo→task mirrors natural mental model
- Activity-based filtering is particularly useful for retrospectives
- JSON output enables integration with other tools
- Future AI analysis could provide valuable insights

## Time Investment
- Specification writing: ~30 minutes
- Research and design: ~15 minutes
- Documentation: ~10 minutes
- **Total: ~55 minutes**

---

## Update: High-Level Design Document Created

### Additional Work Completed

Created comprehensive High-Level Design (HLD) document: `wrk_docs/2025.11.12 - HLD - Journal Review Tool Implementation.md`

**HLD Contents:**
1. **Executive Summary** - Goals, features, and non-goals
2. **System Overview** - Context diagram, architecture, technology stack
3. **Architecture Design** - Layered architecture, module organization
4. **Module Design** - Detailed design for all 5 modules:
   - CLI Module (argument parsing, command handling)
   - Scanner Module (directory walking, file matching, repo detection)
   - Parser Module (markdown parsing, task extraction, activity extraction)
   - Analyzer Module (grouping, filtering, statistics)
   - Formatter Module (text, JSON, markdown output)
5. **Data Flow** - End-to-end data flow diagram
6. **Detailed Component Design** - Rust code structures with examples
7. **Error Handling Strategy** - Custom error types, handling guidelines
8. **Performance Considerations** - Optimization strategies, benchmarking, targets
9. **Security Considerations** - Threat model, security measures
10. **Testing Strategy** - Unit, integration, E2E tests with coverage goals
11. **Implementation Roadmap** - 5-phase plan with deliverables
12. **Appendices** - Complete data structures, configuration reference, Cargo.toml

**Key Design Elements:**
- Complete module breakdown with file organization
- Detailed Rust code examples for each component
- Error handling with `anyhow` and `thiserror`
- Performance targets (< 1s for 1000 files end-to-end)
- Parallel processing strategy with `rayon`
- Security measures (file size limits, path validation)
- Comprehensive testing approach
- 6-week implementation roadmap

**Document Statistics:**
- Total lines: ~1,800
- Sections: 12 major sections
- Code examples: 20+ detailed Rust implementations
- Diagrams: 4 architecture/flow diagrams
- Appendices: Complete reference material

### Design Highlights

**Layered Architecture:**
```
Presentation (CLI & Output)
    ↓
Application Logic
    ↓
Domain Services (Scanner, Parser, Analyzer)
    ↓
Data & Infrastructure
```

**Module Organization:**
- Clean separation of concerns
- Testable components
- Reusable modules
- Clear dependencies

**Data Flow Pipeline:**
```
CLI Args → Config → Scanner → Parser → Filter → Analyzer → Formatter → Output
```

**Performance Strategy:**
- Parallel file processing with rayon
- Lazy evaluation where possible
- Efficient data structures (HashMap, HashSet)
- Early filtering to reduce processing
- Target: < 1 second for 1000 journals

**Security Measures:**
- File size limits (10MB max)
- Path validation and canonicalization
- No code execution from journal files
- Symlink handling controls
- Input sanitization

### Time Investment (Update)
- HLD document writing: ~60 minutes
- Architecture design: ~20 minutes
- Code structure planning: ~15 minutes
- **Session Total: ~150 minutes (2.5 hours)**

---

**Repository:** experiment (0x4D44/experiment)
**Branch:** claude/create-jrnrvw-spec-011CV3dHQDpxtVEwJbM89nhm
**Related Tasks:** Initial project setup, tool specification, high-level design
**Tags:** #specification #hld #rust #cli #journal-analysis #tooling #architecture
