# Isometric 2.5D Rendering Implementation Plan

**Date:** 2025-11-17
**Goal:** Implement authentic F1GP-style isometric 2.5D rendering
**Target:** Bring project from 60% â†’ 90%+ toward v1.0

---

## Research: Original F1GP Rendering

### What the Original Used

The 1991 Formula 1 Grand Prix by Geoff Crammond used:

1. **Isometric Projection**
   - Fixed camera angle (~30Â° from horizontal)
   - Isometric viewing angle (not true 3D perspective)
   - Similar to strategy games like SimCity 2000, Command & Conquer

2. **Track Rendering**
   - Track segments rendered as polygons with isometric transform
   - Road surface shown at an angle
   - Track boundaries and kerbs visible in 3D space

3. **Car Sprites**
   - Pre-rendered sprites from 16-32 angles
   - Cars scaled based on "distance" (Y coordinate)
   - Simple depth sorting (Y-axis determines draw order)

4. **Visual Style**
   - Can see track layout from above at an angle
   - Cars appear to move "into" the screen
   - Grass, gravel, and track surface all visible

---

## Technical Approach

### Option 1: Modify 2D Camera (âœ… CHOSEN)
- Add isometric projection to existing Camera
- Transform world coords â†’ isometric screen coords
- Keep existing SDL2 rendering
- Simpler, more authentic to original

### Option 2: Use Render3D Module
- Already has perspective 3D rendering
- Would need to convert to orthographic isometric
- More complex, not needed for 2.5D

---

## Implementation Plan

### Phase 1: Isometric Camera Transform

**File:** `src/render/camera.rs`

Add isometric projection method:

```rust
/// Isometric projection constants
const ISO_ANGLE: f32 = 30.0; // degrees from horizontal
const ISO_SCALE_X: f32 = 1.0;
const ISO_SCALE_Y: f32 = 0.5; // Isometric Y compression

pub fn world_to_screen_isometric(&self, world_pos: Vec3) -> Vec2 {
    // Isometric transformation matrix
    // x_screen = (world.x - world.z) * scale
    // y_screen = (world.x + world.z) * scale/2 - world.y

    let iso_x = (world_pos.x - world_pos.z) * ISO_SCALE_X;
    let iso_y = (world_pos.x + world_pos.z) * ISO_SCALE_Y - world_pos.y;

    // Apply camera transform (center, zoom)
    let screen_x = (iso_x - self.position.x) * self.zoom + viewport_w / 2;
    let screen_y = (iso_y - self.position.y) * self.zoom + viewport_h / 2;

    Vec2::new(screen_x, screen_y)
}
```

### Phase 2: Track Rendering

**File:** `src/render/track_renderer.rs`

Modify track rendering to use isometric projection:
- Transform track segments using isometric camera
- Render track surface as polygons (not just centerline)
- Add track boundaries, kerbs in isometric view

### Phase 3: Car Rendering with Depth Sorting

**File:** `src/render/car_renderer.rs` & `src/game/state.rs`

1. Transform car positions using isometric projection
2. Sort cars by Y coordinate before rendering (back to front)
3. Render cars in sorted order for proper layering

### Phase 4: HUD Adjustments

**File:** `src/render/hud.rs`

- Keep HUD in screen space (not isometric)
- May need to adjust positioning for new camera

---

## Testing Plan

1. Test with single car on track - verify isometric look
2. Test with multiple AI cars - verify depth sorting works
3. Test camera zoom/pan - ensure smooth operation
4. Test all 15 tracks - verify rendering quality

---

## Expected Visual Result

```
Before (Top-Down 2D):
  ğŸ‘€
  |
  ğŸï¸â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

After (Isometric 2.5D):
      ğŸ‘€
     /
    /
   â•± ğŸï¸
  â•±â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 â•±
```

The track and cars should appear at an angle, giving depth perception while maintaining 2D rendering efficiency.

---

## Estimated Effort

- Isometric camera transform: 1-2 hours
- Track rendering update: 2-3 hours
- Car rendering + depth sort: 1-2 hours
- Testing and refinement: 1-2 hours
- **Total: 5-9 hours**

---

## Success Criteria

âœ… Track visible in isometric perspective
âœ… Cars render correctly with depth sorting
âœ… Camera zoom/pan works smoothly
âœ… 60 FPS maintained
âœ… Authentic F1GP visual style achieved

---

**Next Steps:** Begin implementation with isometric camera transform
